module.exports=[406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},4298,e=>{"use strict";var t=e.i(6747),r=e.i(9245),n=e.i(4898),a=e.i(2950);async function s(e,t){try{let e=process.env.INCUS_SERVER,r=process.env.IP_PREFIX,n=[];if(e||n.push("INCUS_SERVER"),r||n.push("IP_PREFIX"),n.length>0){console.error("Variables d'environnement manquantes:",n.join(", ")),t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Content-Type","application/json"),t.status(500).json({error:"Configuration incomplète",message:`Variables d'environnement manquantes: ${n.join(", ")}. Veuillez les ajouter dans votre fichier .env.`,missingVariables:n});return}let a=function(e){try{return new URL(e.startsWith("http")?e:`https://${e}`).hostname}catch{return e.replace(/^https?:\/\//,"").split(":")[0].split("/")[0]}}(e),s=`${e}/vnc.html`,i=process.env.CONTAINERS,o=[];if(i)try{if(i.trim().startsWith("["))o=JSON.parse(i);else if(i.trim().startsWith("{")){let e=i.match(/"([^"]+)"/g);o=e?e.map(e=>e.replace(/"/g,"")):[]}else o=i.split(",").map(e=>e.trim().replace(/['"]/g,""))}catch(e){o=i.split(",").map(e=>e.trim().replace(/['"]/g,""))}let l=o.filter(e=>e).map((e,t)=>{let n=`${r}${e}`;return{name:`${t+1}`,ip:n,vncUrl:`${s}#host=${a}&autoconnect=true&scaling=local&path=websockify?token=${n}`}});t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Content-Type","application/json"),t.status(200).json({containers:l,count:l.length})}catch(e){console.error("Erreur:",e),t.setHeader("Access-Control-Allow-Origin","*"),t.status(500).json({error:"Erreur lors de la récupération des containers",message:e.message})}}e.s(["default",()=>s],6368);var i=e.i(6368),o=e.i(7031),l=e.i(1927),p=e.i(6432);let c=(0,a.hoist)(i,"default"),u=(0,a.hoist)(i,"config"),d=new n.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/containers",pathname:"/api/containers",bundlePath:"",filename:""},userland:i,distDir:".next",relativeProjectDir:""});async function m(e,r,n){d.isDev&&(0,p.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/containers";a=a.replace(/\/index$/,"")||"/";let s=await d.prepare(e,r,{srcPage:a});if(!s){r.statusCode=400,r.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve());return}let{query:i,params:c,prerenderManifest:u,routerServerContext:m}=s;try{let t=e.method||"GET",n=(0,o.getTracer)(),s=n.getActiveScopeSpan(),p=d.instrumentationOnRequestError.bind(d),h=async s=>d.render(e,r,{query:{...i,...c},params:c,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:u.preview,propagateError:!1,dev:d.isDev,page:"/api/containers",internalRevalidate:null==m?void 0:m.revalidate,onError:(...t)=>p(e,...t)}).finally(()=>{if(!s)return;s.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let e=n.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==l.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=e.get("next.route");if(i){let e=`${t} ${i}`;s.setAttributes({"next.route":i,"http.route":i,"next.span_name":e}),s.updateName(e)}else s.updateName(`${t} ${a}`)});s?await h(s):await n.withPropagatedContext(e.headers,()=>n.trace(l.BaseServerSpan.handleRequest,{spanName:`${t} ${a}`,kind:o.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},h))}catch(e){if(d.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==n.waitUntil||n.waitUntil.call(n,Promise.resolve())}}e.s(["config",0,u,"default",0,c,"handler",()=>m],4298)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__f4ce0c74._.js.map